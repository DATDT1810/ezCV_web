<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>ezCV - T·∫°o CV chuy√™n nghi·ªáp trong t·∫ßm tay</title>
    <link rel="icon" href="img/core-img/favicon.ico" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/responsive.css" />
</head>

<body class="ali-bg">
    <!-- ##### Blog Area Start ##### -->
    <section class="blog-area">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 col-md-5">
                    <div class="cv-prev">
                        <div class="blog_thumbnail">
                            <img src="img/demos/demo-1.png" class="temp-img" alt="" />
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-7">
                    <div class="cv-download">
                        <div class="row align-items-center">
                            <div class="col-lg-6 col-md-12">
                                <p class="topnote">
                                    ƒêi·ªÅn t·∫•t c·∫£ c√°c tr∆∞·ªùng b·∫Øt bu·ªôc v√† nh·∫•p v√†o "T·∫°o CV" ƒë·ªÉ l∆∞u
                                    d·ªØ li·ªáu c·ªßa b·∫°n.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <!-- Form c√≥ ID r√µ r√†ng -->
                        <form id="cvDataForm">
                            <div class="mt-150">
                                <h2>Th√¥ng tin c√° nh√¢n</h2>
                                <div class="block-container">
                                    <div class="row align-items-center">
                                        <div class="col-lg-2 col-md-4">
                                            <img src="img/test-img/1.jpg" class="d-block" alt="" />
                                        </div>
                                        <div class="col-lg-5 col-md-8 mt-s">
                                            <h6>T·∫£i ·∫£nh c·ªßa b·∫°n</h6>
                                            <p class="text-muted mb-0">
                                                K√≠ch th∆∞·ªõc ƒë·ªÅ xu·∫•t: 300x300 (.jpg ho·∫∑c .png)
                                            </p>
                                        </div>
                                        <div class="col-lg-5 col-md-12 mt-s">
                                            <label for="avatar">T·∫£i ·∫£nh l√™n</label>

                                        </div>
                                    </div>

                                    <div class="mt-30">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <label>T√™n ƒë·∫ßy ƒë·ªß:</label>
                                                <input type="text" name="full-name" class="form-control"
                                                    placeholder="Nh·∫≠p t√™n ƒë·∫ßy ƒë·ªß c·ªßa b·∫°n" required />
                                            </div>

                                            <div class="col-lg-6">
                                                <label>Ti√™u ƒë·ªÅ c√¥ng vi·ªác:</label>
                                                <input type="text" name="job-title" class="form-control"
                                                    placeholder="Ex: L·∫≠p tr√¨nh vi√™n Web" />
                                            </div>

                                            <div class="col-lg-6">
                                                <label>ƒê·ªãa ch·ªâ:</label>
                                                <input type="text" name="address" class="form-control"
                                                    placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ c·ªßa b·∫°n" required />
                                            </div>

                                            <div class="col-lg-6">
                                                <label>Email:</label>
                                                <input type="email" name="email" class="form-control"
                                                    placeholder="Nh·∫≠p email c·ªßa b·∫°n" required />
                                            </div>
                                            <div class="col-lg-6">
                                                <label>Ng√†y th√°ng nƒÉm sinh:</label>
                                                <input type="date" name="birthday" class="form-control"
                                                    placeholder="Nh·∫≠p email c·ªßa b·∫°n" />
                                            </div>

                                            <div class="col-lg-6">
                                                <label>S·ªë ƒëi·ªán tho·∫°i:</label>
                                                <input type="tel" name="phone" class="form-control"
                                                    placeholder="VD: 0901234567" pattern="^(0|\+84)(\d{9})$" required />
                                            </div>

                                            <div class="col-lg-12">
                                                <label>Gi·ªõi thi·ªáu b·∫£n th√¢n (Bio):</label>
                                                <textarea name="comments" rows="4" class="form-control"
                                                    placeholder="Vi·∫øt ng·∫Øn g·ªçn v·ªÅ b·∫£n th√¢n..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- H·ªåC V·∫§N -->
                            <div class="form-group add-social mt-s">
                                <h2>H·ªçc v·∫•n</h2>
                                <div class="block-container">
                                    <div class="all-edus">
                                        <div class="new-edu">
                                            <label>T√™n tr∆∞·ªùng / Trung t√¢m:</label>
                                            <input type="text" class="form-control"
                                                placeholder="V√≠ d·ª•: ƒê·∫°i h·ªçc Kinh t·∫ø TP.HCM" />
                                            <label>Ng√†nh h·ªçc:</label>
                                            <input type="text" class="form-control"
                                                placeholder="V√≠ d·ª•: Qu·∫£n tr·ªã Kinh doanh" />
                                            <label>Th·ªùi gian h·ªçc:</label>
                                            <input type="text" class="form-control" placeholder="V√≠ d·ª•: 2019 - 2023" />
                                        </div>
                                    </div>

                                    <!-- N√∫t th√™m -->
                                    <div class="add-blk add-edu btn btn-info mt-50" id="add-edu">
                                        <i class="fa fa-plus"></i>
                                        <span>Th√™m h·ªçc v·∫•n kh√°c</span>
                                    </div>
                                </div>
                            </div>

                            <!-- KINH NGHI·ªÜM L√ÄM VI·ªÜC -->
                            <div class="form-group add-social mt-s">
                                <h2>Kinh nghi·ªám l√†m vi·ªác</h2>
                                <div class="block-container">
                                    <div class="all-exps">
                                        <div class="new-exp">
                                            <label>T√™n c√¥ng ty:</label>
                                            <input type="text" class="form-control" required
                                                placeholder="V√≠ d·ª•: C√¥ng ty TNHH ABC" />
                                            <label>V·ªã tr√≠:</label>
                                            <input type="text" class="form-control" required
                                                placeholder="V√≠ d·ª•: Nh√¢n vi√™n kinh doanh" />
                                            <label>Th·ªùi gian l√†m vi·ªác:</label>
                                            <input type="text" class="form-control" placeholder="V√≠ d·ª•: 2022 - 2024"
                                                required />
                                        </div>
                                    </div>

                                    <!-- N√∫t th√™m -->
                                    <div class="add-blk add-exp btn btn-info mt-50" id="add-exp">
                                        <i class="fa fa-plus"></i>
                                        <span>Th√™m kinh nghi·ªám kh√°c</span>
                                    </div>
                                </div>
                            </div>

                            <!-- K·ª∏ NƒÇNG -->
                            <div class="form-group add-social mt-s">
                                <h2>K·ªπ nƒÉng</h2>
                                <div class="block-container">
                                    <div class="all-skills">
                                        <div class="new-skills">
                                            <label>K·ªπ nƒÉng:</label>
                                            <input type="text" name="skills[]" class="form-control"
                                                placeholder="VD: HTML, C#, Photoshop..." required />
                                            <label>Tr√¨nh ƒë·ªô:</label>
                                            <input type="text" name="skills[]" class="form-control"
                                                placeholder="VD: C∆° b·∫£n, Trung b√¨nh, Th√†nh th·∫°o..." required />
                                        </div>
                                    </div>

                                    <!-- N√∫t th√™m -->
                                    <div class="add-blk add-skills btn btn-info mt-50">
                                        <i class="fa fa-plus"></i>
                                        <span>Th√™m k·ªπ nƒÉng kh√°c</span>
                                    </div>
                                </div>
                            </div>

                            <!-- S·ªû TH√çCH -->
                            <div class="form-group add-social mt-s">
                                <h2>S·ªü th√≠ch</h2>
                                <div class="block-container">
                                    <div class="all-hoppies">
                                        <div class="new-hoppies">
                                            <label>S·ªü th√≠ch:</label>
                                            <input type="text" class="form-control"
                                                placeholder="V√≠ d·ª•: ƒê·ªçc s√°ch, Du l·ªãch" />
                                        </div>
                                    </div>

                                    <!-- N√∫t th√™m -->
                                    <div class="add-blk add-hoppies btn btn-info mt-50">
                                        <i class="fa fa-plus"></i>
                                        <span>Th√™m s·ªü th√≠ch kh√°c</span>
                                    </div>
                                </div>
                            </div>

                            <hr class="mt-100" />
                            <input type="button" name="submit" value="T·∫°o CV" class="btn-sub" />
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ########## All JS ########## -->
    <!-- jQuery js -->
    <script src="js/jquery.min.js"></script>
    <!-- Popper js -->
    <script src="js/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- All Plugins js -->
    <script src="js/plugins.js"></script>
    <!-- Parallax js -->
    <script src="js/dzsparallaxer.js"></script>
    <!-- Active js -->
    <script src="js/form-script.js"></script>
    <script src="js/script.js"></script>

    <!-- Firebase SDK (compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

    <script>
        // ===============================
        // Firebase Config
        // ===============================
        const firebaseConfig = {
            apiKey: "AIzaSyBiG0G0uzpu4rKWyzVWWxM2y9iGGUn7e0",
            authDomain: "ezcv-60898.firebaseapp.com",
            projectId: "ezcv-60898",
            storageBucket: "ezcv-60898.appspot.com",
            messagingSenderId: "633226888127",
            appId: "1:633226888127:web:bcf0b63f51df7f1d57d70a",
            measurementId: "G-YJ62Z7GTSK",
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        // ===============================
        // Upload Avatar to Firebase Storage
        // ===============================
        async function uploadAvatar(fileInput) {
            const file = fileInput?.files?.[0];
            if (!file) return "";

            try {
                const storageRef = storage.ref(`avatars/${Date.now()}_${file.name}`);
                await storageRef.put(file);
                return await storageRef.getDownloadURL();
            } catch (error) {
                console.error(" L·ªói upload ·∫£nh:", error);
                alert("Kh√¥ng th·ªÉ upload ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i!");
                return "";
            }
        }

        // ===============================
        // Thu th·∫≠p d·ªØ li·ªáu h·ªçc v·∫•n, kinh nghi·ªám, k·ªπ nƒÉng, s·ªü th√≠ch
        // ===============================
        function collectCVData() {
            const form = document.getElementById("cvDataForm");
            const formData = new FormData(form);

            const data = {
                fullName: formData.get("full-name") || "",
                jobTitle: formData.get("job-title") || "",
                address: formData.get("address") || "",
                email: formData.get("email") || "",
                phone: formData.get("phone") || "",
                birthday: formData.get("birthday") || "",
                organic: formData.get("comments") || "",
            };

            // üîπ H·ªçc v·∫•n
            data.education = [];
            document.querySelectorAll(".new-edu").forEach(edu => {
                const inputs = edu.querySelectorAll("input");
                data.education.push({
                    school: inputs[0]?.value || "",
                    subject: inputs[1]?.value || "",
                    degree: "C·ª≠ nh√¢n",
                    fromMonth: "",
                    toMonth: inputs[2]?.value || "",
                });
            });

            // üîπ Kinh nghi·ªám
            data.experience = [];
            document.querySelectorAll(".new-exp").forEach(exp => {
                const inputs = exp.querySelectorAll("input");
                data.experience.push({
                    company: inputs[0]?.value || "",
                    title: inputs[1]?.value || "",
                    description: "",
                    fromMonth: "",
                    toMonth: inputs[2]?.value || "",
                });
            });

            // üîπ K·ªπ nƒÉng
            data.skills = [];
            document.querySelectorAll(".new-skills").forEach(skill => {
                const inputs = skill.querySelectorAll("input");
                data.skills.push({
                    skillName: inputs[0]?.value || "",
                    level: inputs[1]?.value || "",
                });
            });

            // üîπ S·ªü th√≠ch
            data.hobbies = [];
            document.querySelectorAll(".new-hoppies").forEach(h => {
                const inputs = h.querySelectorAll("input");
                data.hobbies.push({ hobbyName: inputs[0]?.value || "" });
            });

            return data;
        }

        // ===============================
        // L∆∞u d·ªØ li·ªáu v√†o Firestore
        // ===============================
        async function saveCVToFirestore(cvData) {
            try {
                await db.collection("user_cvs").add({
                    ...cvData,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                });
                alert(" CV c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!");
            } catch (error) {
                console.error(" L·ªói l∆∞u Firestore:", error);
                alert("Kh√¥ng th·ªÉ l∆∞u d·ªØ li·ªáu l√™n Firebase!");
            }
        }

        // ===============================
        // Submit form
        // ===============================
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("cvDataForm");
            const avatarInput = document.getElementById("avatar");
            const submitButton = document.querySelector(".btn-sub");

            // N·∫øu form ch∆∞a c√≥ input file th√¨ th√™m
            if (!avatarInput) {
                const label = document.querySelector('label[for="avatar"]');
                const input = document.createElement("input");
                input.type = "file";
                input.id = "avatar";
                input.accept = "image/*";
                label.parentNode.appendChild(input);
            }

            form.addEventListener("submit", async (e) => {
                e.preventDefault();
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                submitButton.disabled = true;
                submitButton.value = "ƒêang l∆∞u...";

                //  Thu th·∫≠p d·ªØ li·ªáu
                const data = collectCVData();

                //  Upload ·∫£nh
                const avatarUrl = await uploadAvatar(document.getElementById("avatar"));
                if (avatarUrl) data.avatar = avatarUrl;

                // L∆∞u Firestore
                await saveCVToFirestore(data);

                submitButton.disabled = false;
                submitButton.value = "T·∫°o CV";
                form.reset();
            });
        });
    </script>


</body>

</html>